var Card,Game,Hand,barContainer,cardValue,controlsContainer,dealerContainer,dealerHand,hiddenCard,playerContainer,playerHand,suits;suits=["club","diamond","heart","spade"],cardValue=["a",2,3,4,5,6,7,8,9,10,"j","q","k"],playerContainer="#player",dealerContainer="#dealer",controlsContainer="#controls",barContainer="#msg",Game={deal:function(){var a,b;return b=Math.floor(Math.random()*suits.length),a=Math.floor(Math.random()*cardValue.length),new Card(b,a)},hitUser:function(a){var b,c,d;if("player"===a)b=playerHand.hitMe(),d=playerContainer;else{if("dealer"!==a)throw"hitUser function needs a role";b=dealerHand.hitMe(),d=dealerContainer}c=b.getCard(),$(c).appendTo(d).addClass("placed")},createHand:function(a){var b,c,d,e,f,g,h;if(c=new Hand,e=c.getHand(),f=null,"player"===a)f=playerContainer;else{if("dealer"!==a)throw"createHand function needs a role";f=dealerContainer}for(g=0,h=e.length;h>g;g++)b=e[g],d=e[g].getCard(),"dealer"===a&&0===g?(d=e[g].getCard("hidden"),hiddenCard=e[g].getCard()):d=e[g].getCard(),$(f).append(d);return"player"===a&&Game.helpers.updateBar("Your hand is "+c.score()+", press Hit or Stand"),c},declareWinner:function(a){var b,c,d;return d="You got "+a.score(),b="dealer got "+dealerHand.score(),c=d+", "+b,21===a.score()?d+"! Blackjack!":a.score()>21?dealerHand.score()>21?c+". You tied!":c+". You lose!":dealerHand.score()>21?c+". You win!":a.score()>dealerHand.score()?c+". You win!":a.score()===dealerHand.score()?c+". You tied!":c+"! You lose!"},helpers:{dealAnimate:function(){$(".hand").each(function(){var a,b,c,d;a=0,c=$(this),b=c.find(".card"),d=setInterval(function(){$(b[a]).addClass("placed"),a===b.length&&clearInterval(this),a++},200)})},updateBar:function(a){$(barContainer).text(a)},stopControls:function(){$(controlsContainer).find("#hit, #stand").addClass("dis")}},play:{finish:function(){Game.helpers.stopControls(),$(dealerContainer).find(".card:first-child").remove(),$(hiddenCard).prependTo(dealerContainer).addClass("rolled"),Game.helpers.updateBar(Game.declareWinner(playerHand,dealerHand)),$(controlsContainer).find("#restart").show()},evaluate:function(){playerHand.score()>=21?Game.play.finish():playerHand.score()<21?(Game.hitUser("player"),dealerHand.score()<17&&(Game.hitUser("dealer"),dealerHand.score()>=21&&Game.play.finish()),playerHand.score()>=21||dealerHand.score()>=21?Game.play.finish():Game.helpers.updateBar("Your hand is "+playerHand.score()+", press Hit or Stand")):Game.play.finish()}},startScreen:function(){$("#cover").css("visibility","visible"),$("#logo").transition({x:"-50em"},0).transition({x:"0"},600,"in-out"),$("#new-game").transition({x:"-50em"},0),$("#new-game").transition({x:"0"},600,"in-out"),$("#logo").transition({perspective:"439px",rotateY:"0deg"}).transition({perspective:"439px",rotateY:"360deg"},600)},startNew:function(){playerHand=Game.createHand("player"),dealerHand=Game.createHand("dealer"),Game.helpers.dealAnimate(),playerHand.score()>=21&&Game.play.finish()},init:function(){Game.startScreen(),$("#new-game").on("click",function(){return $(".webfont-preload").remove(),Game.startNew(),$("#cover").hide(),$("#game").css("visibility","visible"),!1}),$(controlsContainer).on("click","#hit:not(.dis)",function(){return Game.play.evaluate(),!1}),$(controlsContainer).on("click","#stand:not(.dis)",function(){return Game.play.finish(),!1}),$(controlsContainer).on("click","#restart",function(){return $(".card").remove(),$(controlsContainer).find("#hit, #stand").removeClass("dis"),$(controlsContainer).find("#restart").hide(),Game.startNew(),!1})}},Card=function(a,b){var c,d,e;e=a,d=b,c=1===e||2===e?"red":"black",this.getNumber=function(){return d},this.getSuit=function(){return e},this.getLetter=function(){return cardValue[d]},this.getValue=function(){return 1===d?11:d>1&&10>d?d:10},this.getCard=function(a){var b;return"hidden"===a?b='<div class="card unknown"></div>':(b='<div class="card ',b+=suits[e]+" "+c+" card-"+cardValue[d],b+='" data-number="'+cardValue[d]+'">',b+='<div class="cover"></div><div class="deck"></div>'),b}},Hand=function(){var a,b,c;a=Game.deal(),b=Game.deal(),c=[a,b],this.getFirstCard=function(){return a},this.getSecondCard=function(){return b},this.getHand=function(){return c},this.score=function(){var a,b,d,e,f;for(d=0,a=0,e=0,f=c.length;f>e;e++)b=c[e],d+=c[e].getValue(),d+=1,11===c[e].getValue()&&(a+=1);for(;a>0&&d>21;)d-=10,a--;return d},this.hitMe=function(){var a;return a=Game.deal(),c.push(a),a}},$(document).ready(function(){Game.init()});